# ********RoostGPT********

# Test generated by RoostGPT for test test-workflow using AI Type Azure Open AI and AI Model roostgpt-4-32k
# 
# ROOST_METHOD_HASH=a9879f53dd
# ROOST_METHOD_SIG_HASH=274379bd8a
# 
#  ########## Scenario ########## 
# 
# {
#   feature: 'Feature: Test API from Alphavantage.co',
#   background: null,
#   rule: null,
#   scenario: {
#     title: 'Scenario: Get Visa Application Data',
#     steps: 'Given the Finnhub API base URL is "https://finnhub.io/api/v1"\n' +
#       'When I send a GET request to "/visa/application?symbol=AAPL"\n' +
#       'Then the response status code should be 200\n' +
#       'And the response should contain visa application data',
#     examples: ''
#   }
# }
# 

# ********RoostGPT********
Feature: Test API from Alphavantage.co

Background: 
  * def finnhub_URL = karate.properties['FINNHUB_URL'] || karate.get('FINNHUB_URL', 'http://localhost:4010')
  * url finnhub_URL
  * def finnhub_AUTH_TOKEN = karate.properties['FINNHUB_AUTH_TOKEN'] || karate.get('FINNHUB_AUTH_TOKEN')

Scenario: Get Visa Application Data
  Given path '/stock/visa-application'
  And param symbol = 'AAPL'
  And param from = '2021-01-01'
  And param to = '2021-12-31'
  And param token = finnhub_AUTH_TOKEN
  When method get
  Then status 200
  And match $ contains
    """ 
    { 
      symbol: '#string',
      data: '#[0..10]',
      'data[0]': {
        year: '#number',
        quarter: '#number',
        symbol: '#string',
        caseNumber: '#string',
        caseStatus: '#string',
        receivedDate: '#string',
        visaClass: '#string',
        jobTitle: '#string',
        socCode: '#string',
        fullTimePosition: '#string',
        beginDate: '#string',
        endDate: '#string',
        employerName: '#string',
        worksiteAddress: '#string',
        worksiteCity: '#string',
        worksiteCounty: '#string',
        worksiteState: '#string',
        worksitePostalCode: '#string',
        wageRangeFrom: '#number',
        wageRangeTo: '#number',
        wageUnitOfPay: '#string',
        wageLevel: '#string',
        h1bDependent: '#string'
      }
    }
    """

Scenario: Get Visa Application Data with invalid symbol
  Given path '/stock/visa-application'
  And param symbol = 'INVALID'
  And param from = '2021-01-01'
  And param to = '2021-12-31'
  And param token = finnhub_AUTH_TOKEN
  When method get
  Then status 404
